#!/bin/bash

init_screen () {
# Set up nested X server
Xephyr -keybd ephyr,,,xkbmodel=evdev -br -reset -screen 1280x720x24 -dpi 96 :2 &
sleep 3
}

start_screen_gnome () {
gnome-panel &
nautilus
}

start_screen_kde4 () {
export DISPLAY=:2.0
export KWIN_COMPOSE=N

killall plasma-desktop
plasma-desktop
kwin

export DISPLAY=:0
plasma-desktop
}

case $1 in
  gnome|-gnome|--gnome)
init_screen
start_screen_gnome
  ;;

  kde4|-kde4|--kde4)
init_screen
start_screen_kde4
  ;;

  *)
echo "usage: xrec_1 <DE>

DE can be:
    -gnome      Gnome session
    -kde4       KDE4 session
"
  ;;

esac
